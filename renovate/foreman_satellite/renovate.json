{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "gomod": {
    "baseBranchPatterns": ["master", "main", "/^foreman-.*$/", "/^SATELLITE-.*$/"],
    "packageRules": [
      {
        "matchBaseBranches": ["/^foreman-.*$/", "/^SATELLITE-.*$/"],
        "description": "Disable gomod manager on foreman/satellite branches. This is needed to override default mintmaker config.",
        "matchManagers": ["gomod"],
        "enabled": false
      },
      {
        "matchBaseBranches": ["/^foreman-.*$/", "/^SATELLITE-.*$/"],
        "description": "Enable security alerts for go dependencies on foreman/satellite branches.",
        "matchManagers": ["gomod"],
        "osvVulnerabilityAlerts": true
      }
    ]
  },
  "baseBranchPatterns": ["master", "main", "/^foreman-.*$/", "/^SATELLITE-.*$/"],
  "packageRules": [
    {
      "matchBaseBranches": ["/^foreman-.*$/", "/^SATELLITE-.*$/"],
      "description": "Disable all managers except specific managers on foreman/satellite branches",
      "matchManagers": ["!tekton", "!dockerfile", "!rpm-lockfile"],
      "enabled": false
    },
    {
      "matchBaseBranches": ["/^foreman-.*$/", "/^SATELLITE-.*$/"],
      "description": "Updates of Dockerfile and RPMs for foreman/satellite branches with immediate schedule",
      "matchManagers": ["dockerfile"],
      "enabled": true,
      "postUpgradeTasks": {
        "commands": ["rpm-lockfile-prototype rpms.in.yaml"],
        "fileFilters": ["**/rpms.lock.yaml"]
      },
      "schedule": ["at any time"]
    },
    {
      "matchBaseBranches": ["/^foreman-.*$/", "/^SATELLITE-.*$/"],
      "description": "Disable non-security RPM updates for foreman/satellite branches",
      "matchManagers": ["rpm-lockfile"],
      "matchJsonata": [
          "$not($exists(isVulnerabilityAlert)) or isVulnerabilityAlert = false"
      ],
      "enabled": false
    },
    {
      "matchBaseBranches": ["/^foreman-.*$/", "/^SATELLITE-.*$/"],
      "description": "Updates of security RPMs for foreman/satellite branches with immediate schedule",
      "matchManagers": ["rpm-lockfile"],
      "matchJsonata": [
          "$exists(isVulnerabilityAlert) and isVulnerabilityAlert = true"
      ],
      "enabled": true,
      "schedule": ["at any time"]
    },
    {
      "matchBaseBranches": ["/^foreman-.*$/", "/^SATELLITE-.*$/"],
      "description": "Disable non-iop Konflux pipeline updates for foreman/satellite branches",
      "matchManagers": ["tekton"],
      "matchFileNames": ["!.tekton/iop-*.yaml"],
      "enabled": false
    },
    {
      "matchBaseBranches": ["/^foreman-.*$/", "/^SATELLITE-.*$/"],
      "description": "Konflux pipeline updates for foreman/satellite branches with weekly schedule",
      "matchManagers": ["tekton"],
      "enabled": true,
      "schedule": ["every weekend"]
    },
    {
      "matchBaseBranches": ["/^foreman-.*$/", "/^SATELLITE-.*$/"],
      "description": "Enable security alerts for application dependencies on foreman/satellite branches.",
      "matchManagers": ["!tekton", "!dockerfile", "!rpm-lockfile"],
      "osvVulnerabilityAlerts": true
    }
  ]
}
